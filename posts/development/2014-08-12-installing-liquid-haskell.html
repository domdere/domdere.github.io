<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>Installing Liquid Haskell</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <!-- facebook open graph tags -->

        <meta property="og:type" content="article" />
        <meta property="og:url" content="http://irreverentfeats.com/posts/development/2014-08-12-installing-liquid-haskell.html" />
        <meta property="og:title" content="Installing Liquid Haskell" />
        <meta property="og:description" content="What the title says" />
        
          <meta property="og:image" content="http://irreverentpixelfeats.com/images/fb-logo.png" />
        

        <!---— twitter card tags additive with the og: tags ---->
        <meta name="twitter:card" content="summary_large_image">
        <!-- warning: domain is baked in here... -->
        <meta name="twitter:domain" value="irreverentfeats.com" />
        <meta name="twitter:title" value="Installing Liquid Haskell" />
        <meta name="twitter:description" value="What the title says" />
        
          <meta name="twitter:image" content="http://irreverentpixelfeats.com/images/logo-and-typography-orange.png" />
        
        <meta name="twitter:url" value="http://irreverentpixelfeats.com/posts/development/2014-08-12-installing-liquid-haskell.html" />
        <meta name="twitter:label1" value="Author" />
        
          <meta name="twitter:data1" value="Dom De Re" />
        
        <meta name="twitter:label2" value="Reading Time" />
        
          <meta name="twitter:data2" value="4 mins" />
        

        <meta name="description" content="What the title says">
        <meta name="author" content="Dom De Re">
        <!-- favicons -->
        <link rel="apple-touch-icon" sizes="114x114" href="../../images/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="../../images/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="../../images/favicon-16x16.png">
        <link rel="manifest" href="../../images/manifest.json">
        <link rel="mask-icon" href="../../images/safari-pinned-tab.svg" color="#5bbad5">
        <link rel="shortcut icon" href="../../images/favicon.ico">
        <meta name="msapplication-config" content="/images/browserconfig.xml">
        <meta name="theme-color" content="#ffffff">

        <!-- styles -->
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/bootstrap-theme.min.css" rel="stylesheet">
        <link href="../../css/fonts.css" rel="stylesheet">
        <link href="../../css/irreverent.css" rel="stylesheet">
        <link href="../../css/pandoc.css" rel="stylesheet">

        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
        <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

        <!-- Fav and touch icons -->
        <link rel="shortcut icon" href="../../ico/favicon.ico">

    </head>
    <body>
        <div class="no-gradient-fill navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../../">The Forgetful Functor</a>
                </div>
                <div class="navbar-collapse collapse">
                    <ul class="irreverent-navbar nav navbar-nav">
                        <li><a href="../../">Home</a></li>
                        <li><a href="../../posts.html">Posts</a></li>
                        <li><a href="../../contact.html">Contact</a></li>
                        <li><a href="../../about.html">About</a></li>
                        <!--li ><a href="/posts.html">Posts</a></li-->
                    </ul>
                </div>
            </div>
        </div>

        <hr />
        <div class="container">
            <h1>Installing Liquid Haskell</h1>

<div class="info">
    <i class="fa fa-calendar" aria-hidden="true"></i> <time datetime="2014-08-12" pubdate data-updated="true">August 12, 2014</time>
</div>


<div class="info">
    <i class="fa fa-user-circle" aria-hidden="true"></i> Dom De Re
</div>





<div class="info">
    <i class="fa fa-clock-o" aria-hidden="true"></i> 4 mins
</div>


<div class="info">
    <i class="fa fa-folder" aria-hidden="true"></i> <a href="../../categories/development.html">development</a>
</div>


<div class="info">
    <i class="fa fa-bookmark" aria-hidden="true"></i> <a href="../../tags/liquid%20haskell.html">liquid haskell</a>, <a href="../../tags/z3.html">z3</a>, <a href="../../tags/refined%20types.html">refined types</a>
</div>


<p>I’m looking to try out <a href="http://goto.ucsd.edu/~rjhala/liquid/haskell/blog/about/" title="About Liquid Haskell"><strong>Liquid Haskell</strong></a> in preparation for a blog post so figured I would document the installation experience.</p>
<!-- more -->
<p>(So I’ll save the details and motivation for looking at <strong>Liquid Haskell</strong> until then)</p>
<p>Its more to document the inconvenience and hoops I had to jump through. Part of what I would like to comment on is the hassle/ease of installing it.</p>
<h2 id="prequisites">Prequisites</h2>
<p>So <strong>Liquid Haskell</strong> requires the following:</p>
<ul>
<li>A recent <strong>Ocaml</strong> compiler…</li>
<li><a href="http://z3.codeplex.com/" title="Z3"><strong>Z3</strong></a></li>
</ul>
<h3 id="installing-the-latest-version-of-git">Installing the latest version of Git</h3>
<p>I was running the version of <strong>Git</strong> from the aptitude <code>git</code> package (version <code>1.9.1</code>) and was getting this error:</p>
<pre><code>% git clone https://git01.codeplex.com/z3
Cloning into 'z3'...
remote: Counting objects: 23690, done.
remote: Compressing objects: 100% (5648/5648), done.
remote: Total 23690 (delta 18425), reused 23042 (delta 17944)
Receiving objects: 100% (23690/23690), 9.65 MiB | 184.00 KiB/s, done.
error: RPC failed; result=56, HTTP code = 200
Resolving deltas: 100% (18425/18425), done.</code></pre>
<p>Apparently the problem is due to the PPA distributed binaries being linked to <code>libcurl3-openssl</code>, so the solution is to build them from source and link them to <code>libcurl4-openssl</code></p>
<p>The following builds and installs latest version of <code>git</code> (version <code>2.0.3</code> at the time of this writing) from source.</p>
<pre><code>% sudo apt-get install gettext zlib1g-dev asciidoc libcurl4-openssl-dev
% git clone git@github.com:git/git.git
% cd git
% git checkout v2.0.3
% make configure
% ./configure --prefix=/usr
% make all doc
% sudo make install install-doc install-html</code></pre>
<h3 id="installing-z3">Installing Z3</h3>
<p>Instructions for installing <strong>Z3</strong> for Ubuntu are <a href="http://z3.codeplex.com/SourceControl/latest#README" title="Z3 Installation Instructions"><strong>here</strong></a> (little hard to find).</p>
<p>But just in case whatever, they are again listed here (I didn’t want to install it to <code>/usr/bin</code>, but <code>~/bin</code> instead):</p>
<p>Its also important to install version <code>4.3.2</code> and above.</p>
<pre><code>% git clone https://git01.codeplex.com/z3
% cd z3
% autoconf
% ./configure --prefix=~/bin
% python scripts/mk_make.py
% cd build
% make -j8
% sudo make install</code></pre>
<p>I had previously tried <code>4.3.1</code> as it was the “stable” release, however when I eventually tried verifying a module, I got the following error:</p>
<pre><code>Error setting 'MODEL.PARTIAL', reason: unknown option.
ERROR: invalid INI file
Fatal error: exception Failure(&quot;bracket hits exn: Failure(&quot;bracket hits exn: End_of_file \n&quot;) 
&quot;)</code></pre>
<p>When I replaced it with the <code>4.3.2</code> version of <code>z3</code>, it worked.</p>
<h3 id="building-the-ocaml-compiler">Building the OCaml Compiler</h3>
<p>Instructions are <a href="https://github.com/ocaml/ocaml/blob/trunk/INSTALL" title="OCaml Installation Instructions"><strong>here</strong></a>.</p>
<p>Again just in case and to compare:</p>
<pre><code>% git clone git@github.com:ocaml/ocaml.git
% cd ocaml
% git checkout 4.01.0
% ./configure
% make world
% make bootstrap
% make opt
% make opt.opt
% umask 022
% make install
% make clean</code></pre>
<h2 id="installing-ghc-version-4.8.3">Installing GHC version 4.8.3</h2>
<p>Liquid Haskell needs <strong>GHC</strong>, version <code>4.8.3</code>, instructions to build it from source are <a href="https://ghc.haskell.org/trac/ghc/wiki/Building/QuickStart" title="GHC Installation Instructions"><strong>here</strong></a></p>
<h2 id="installing-liquid-haskell">Installing Liquid Haskell</h2>
<pre><code>% mkdir -p ~/haskell-tools/liquid-haskell
% cd ~/haskell-tools/liquid-haskell
% git clone git@github.com:ucsd-progsys/liquid-fixpoint.git
% git clone git@github.com:ucsd-progsys/liquidhaskell.git
% cabal sandbox init
% cabal sandbox add-source liquid-fixpoint
% cabal sandbox add-source liquidhaskell
% cabal install liquid-fixpoint
% cabal install liquidhaskell
% mkdir -p ~/haskell-tools/bin
% cd ~/haskell-tools/bin
% ln -sf ~/haskell-tools/liquid-haskell/.cabal-sandbox/bin/liquid .
% ln -sf ~/haskell-tools/liquid-haskell/.cabal-sandbox/bin/fixpoint .</code></pre>


            <hr />

            <footer>
                <div class="text-center">
                    <ul class="list-inline">
                        <li>
                            <a href="https://twitter.com/dom_dere" data-datatype="json" data-type="GET" data-target="#frame" class="reload" id="clickme" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="https://github.com/domdere" data-datatype="json" data-type="GET" data-target="#frame" class="reload" id="clickme" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="http://blog.forgetfulfunctor.com/atom.feed" data-datatype="json" data-type="GET" data-target="#frame" class="reload" id="clickme" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-rss-square fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    </ul>
                    <p class="copyright">
                        Copyright <i class="fa fa-copyright" aria-hidden="true"></i> 2014 - 2018 Dom De Re
                        <br>
                        </br>
                    </p>
                </div>
                <div class="text-center">
                  Site proudly generated by
                  <a href="http://jaspervdj.be/hakyll">Hakyll</a>
                </div>
            </footer>

        </div>

        <!-- Bootstrap core JavaScript
        ================================================== -->
        <!-- Placed at the end of the document so the pages load faster -->
        <script src="../../js/jquery-1.11.0.min.js"></script>
        <script src="../../js/bootstrap.min.js"></script>


    </body>
</html>
